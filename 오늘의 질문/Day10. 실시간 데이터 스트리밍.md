# 실시간 데이터 스트리밍
### 실시간 데이터 스트리밍 환경에서 지연(latency) 문제를 해결하거나, 처리 안정성을 높이기 위해 어떤 설계를 했는지 설명해 주세요.
Kafka, Redis Streams, SSE 등 실시간 처리 기술을 어떤 기준으로 선택했는지와, 지연 최소화를 위해 어떤 구조로 설계했는지를 중심으로 답변하시면 좋습니다.
<br/> <br/>

### 🎯 Redis GEO 설계 및 구현 경험
#### 1. 실시간 처리 기술 선택 기준
Redis GEO는 위치 기반 데이터에 특화된 구조로, 위도·경도 좌표를 기반으로 빠른 위치 저장과 반경 내 탐색을 지원합니다. 메모리 기반의 Redis는 조회 속도가 매우 빠르며, GEOADD, GEORADIUS, GEOPOS와 같은 명령어를 통해 지리 정보를 밀리초 단위로 처리할 수 있어 실시간성이 매우 뛰어납니다.

Kafka는 대용량 이벤트 흐름 처리에 적합하지만 위치 데이터를 기반으로 한 반경 탐색에는 적합하지 않고, Redis Streams 또한 큐 기반 처리로 인해 지연이 발생할 수 있으므로, 반경 내 위치 기반 사용자 탐색이 핵심인 본 시스템에는 Redis GEO가 가장 적합했습니다.

#### 2. 지연 최소화를 위한 구조적 설계
- **개별 사용자 키와 전역 위치 키 분리** <br/> 
사용자별 위치 정보는 client:{id} 키에, 전체 위치 인덱싱은 location_data 키에 저장되어 사용 목적에 따라 분리 관리되었습니다. 이는 위치 저장과 탐색을 동시에 효율적으로 수행하기 위한 구조였습니다.
- **TTL(Time-To-Live) 전략 가능성** <br/> 
저장된 위치 정보에 TTL을 적용해 일정 시간 이후 자동 삭제가 가능하도록 설계되어 있었습니다. 이를 통해 시스템 리소스를 절약하고, 오래된 위치 정보를 기반으로 한 탐색 오류를 방지할 수 있었습니다.
- **저장 후 검증 절차** <br/> 
Redis GEO에 위치 정보를 저장한 후, 실제로 잘 저장되었는지를 즉시 조회해 확인하는 로직이 포함되어 있었습니다. 이는 저장 실패 상황에서 빠르게 예외를 감지하고 대응할 수 있도록 하기 위함이었습니다.
- **위치 변경 시 데이터 정합성 유지** <br/> 
기존 위치 데이터는 삭제한 뒤 새로운 위치를 저장하는 방식으로, 동일 사용자에 대한 중복 기록 없이 항상 최신 상태를 유지하도록 설계되었습니다.
<br/> <br/> 

---

## 🌱 실시간 데이터 스트리밍
- 데이터를 **배치 처리**(batch processing)처럼 일정 주기로 한꺼번에 처리하는 것이 아니라, 데이터가 들어오는 즉시 처리한다.
- 스트리밍 데이터는 일반적으로 연속적인 이벤트의 흐름(stream of events) 으로 생각할 수 있다.
- 보통 대용량 로그, 클릭 스트림, IoT 센서 데이터, 금융 거래 정보 등에서 사용된다.

### 🥕 실시간 처리 기술 선택 기준
| 기준 | 설명 | 예시 |
|------|------|------|
| **처리량 (Throughput)** | 초당 수십만 건 이상의 이벤트를 처리할 수 있는지 | Kafka, Pulsar는 고처리량 환경에 적합 |
| **지연 시간 (Latency)** | 실시간 반응성이 중요한지 여부 | Redis Streams, SSE는 저지연에 유리 |
| **데이터 보존 및 재처리** | 데이터 재전송, 장애 복구가 필요한지 | Kafka는 로그 보존 및 재처리 지원 |
| **운영 복잡도** | 분산 시스템 운영이 가능한지 여부 | Kafka는 복잡, SSE는 간단 |
| **확장성 (Scalability)** | 수평 확장이 가능한지 여부 | Kafka, Pulsar는 클러스터 기반 확장 가능 |
| **소비자 수 (Subscriber Count)** | 이벤트를 동시에 소비할 수 있는 소비자 수 | Kafka/Pulsar는 다수 소비자 지원 |
| **브라우저 기반 푸시** | 클라이언트에 직접 이벤트를 전송해야 하는지 | SSE, WebSocket |
| **인프라 제약** | Redis만 존재하는 등 환경 제한이 있는지 | Redis Streams 선택 가능 |
<br/>

### 🧑🏻‍🌾 대표 기술 간 특성 비교
| 기술 | 장점 | 단점 |
|------|------|------|
| **Kafka** | 고성능, 로그 보존, 다수 소비자, 확장성 우수 | 설치/운영 복잡, 리소스 요구 |
| **Redis Streams** | 설치 쉬움, 낮은 지연, Redis 환경에 적합 | 분산성 낮음, 대규모 처리에는 부적합 |
| **SSE** | 브라우저 푸시 용이, 구현 간단 | 단방향 통신, 브라우저 호환 이슈 있음 |
| **WebSocket** | 양방향 통신 가능, 실시간 상호작용 적합 | 서버 리소스 요구, 연결 유지 비용 큼 |
<br/>

### 🧑🏻‍🌾 설계 시 지연 최소화를 위한 전략
| 전략 | 설명 |
|------|------|
| **경량 메시지 포맷 사용** | Protobuf, Avro 등으로 메시지 크기 최소화 |
| **배치 처리 지양** | 이벤트 단위 스트리밍 처리로 지연 최소화 |
| **Backpressure 대응** | 처리량이 초과될 때 흐름을 조절 |
| **네트워크 홉 최소화** | 거치는 시스템 수를 줄여 네트워크 지연 감소 |
| **로컬 캐시 사용** | Redis 등을 이용해 응답 시간 단축 |
| **우선순위 큐 구성** | 중요 이벤트 먼저 처리하여 실시간성 확보 |
| **Consume-Process-Produce 분리** | 처리 단계를 분리하여 병렬화 가능 |
| **지속적 모니터링** | Prometheus, Grafana 등으로 지연 상태 감시 |
